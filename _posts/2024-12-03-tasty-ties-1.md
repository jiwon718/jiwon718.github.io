---
title: "[ë§›ì‡ë‹¤] Spring Boot + WebSocketì„ í™œìš©í•œ ê°„ë‹¨í•œ ì±„íŒ… êµ¬í˜„"
date: 2024-12-03 20:52:00 +0900
categories: [Project]
tags: [ë§›ì‡ë‹¤, spring boot, websocket]
---



ë§›ì‡ë‹¤ëŠ” ë²ˆì—­ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ëŠ” ì˜¨ë¼ì¸ ì¿ í‚¹ í´ë˜ìŠ¤ ì›¹ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤. ë§›ì‡ë‹¤ì— ì—¬ëŸ¬ ê°€ì§€ ê¸°ëŠ¥ì´ ìˆì§€ë§Œ, ê·¸ ì¤‘ì—ì„œ ì‚¬ìš©ìë“¤ ê°„ ë‹¤ëŒ€ë‹¤ ì±„íŒ…ì„ ë‹´ë‹¹í•˜ì—¬ ê°œë°œí•˜ì˜€ìŠµë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ê·¸ ì±„íŒ…ì„ ê°œë°œí•˜ëŠ” ê³¼ì • ì¤‘ ì²« ë²ˆì§¸ì¸ Spring WebSocketì„ í™œìš©í•˜ì—¬ ê°„ë‹¨í•˜ê²Œ ì±„íŒ…ì„ êµ¬í˜„í•œ ê²ƒì— ëŒ€í•´ì„œ ê³µìœ í•˜ë ¤ê³  í•©ë‹ˆë‹¤.

ê°„ë‹¨í•˜ê²Œ í´ë¼ì´ì–¸íŠ¸ê°€ ì´ë¦„ì„ ì „ì†¡í•˜ë©´, í•´ë‹¹ ì±„íŒ…ì— ì°¸ê°€í•˜ê³  ìˆëŠ” ëª¨ë“  ì°¸ê°€ë“¤ì—ê²Œ 'Hello {ì´ë¦„}!'ë¼ëŠ” ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•˜ëŠ” ì±„íŒ…ì„ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤.

í•´ë‹¹ ë‚´ìš©ì€ [Spring Boot ê³µì‹ ë¬¸ì„œ]ë¥¼ ì°¸ê³ í•˜ì˜€ìŠµë‹ˆë‹¤.

[Spring Boot ê³µì‹ ë¬¸ì„œ]: https://spring.io/guides/gs/messaging-stomp-websocket



<br/><br/>



---

# âš™ Spring Boot í”„ë¡œì íŠ¸ ê¸°ë³¸ì„¸íŒ…

WebSocketì„ í™œìš©í•˜ì—¬ ì±„íŒ…ì„ êµ¬í˜„í•˜ëŠ” ë°ì— í•„ìš”í•œ íŒ¨í‚¤ì§€ ì™¸ì— ê°œë°œí•˜ëŠ” ë°ì— ìœ ìš©í•œ íŒ¨í‚¤ì§€ë„ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•˜ì˜€ìŠµë‹ˆë‹¤.

> - Spring Web
> - Spring Boot DevTools
> - WebSocket



<br/><br/>



---

# âœ¨ ê¸°ëŠ¥ êµ¬í˜„

## WebSocket ë° Stomp ì„¤ì •

WebSocketê³¼ Stomp ê´€ë ¨ëœ ì„¤ì •ì„ í•©ë‹ˆë‹¤.

```java
import org.springframework.context.annotation.Configuration;
import org.springframework.messaging.simp.config.MessageBrokerRegistry;
import org.springframework.web.socket.config.annotation.EnableWebSocketMessageBroker;
import org.springframework.web.socket.config.annotation.StompEndpointRegistry;
import org.springframework.web.socket.config.annotation.WebSocketMessageBrokerConfigurer;

@Configuration
@EnableWebSocketMessageBroker
public class WebSocketConfig implements WebSocketMessageBrokerConfigurer {

    @Override
    public void configureMessageBroker(MessageBrokerRegistry config) {
        config.enableSimpleBroker("/topic");
        config.setApplicationDestinationPrefixes("/app");
    }

    @Override
    public void registerStompEndpoints(StompEndpointRegistry registry) {
        registry.addEndpoint("/chatting");
    }

}
```
{: file="WebSocketConfig.java"}

- `@Configuration`: í•´ë‹¹ í´ë˜ìŠ¤ê°€ Spring Bootì—ê²Œ êµ¬ì„± í´ë˜ìŠ¤ì„ì„ ì•Œë¦½ë‹ˆë‹¤.
- `@EnableWebSocketMessageBroker`: ë©”ì„¸ì§€ ë¸Œë¡œì»¤ì˜ ì§€ì›ì„ ë°›ëŠ” WebSocket ë©”ì„¸ì§€ ì²˜ë¦¬ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.
- `configureMessageBroker(MessageBrokerRegistry config)`
    : ë©”ì„¸ì§€ ë¸Œë¡œì»¤ì™€ ê´€ë ¨ëœ ì„¤ì •ì„ í•©ë‹ˆë‹¤.
    - `config.enableSimpleBroker("/topic");`
        : ì£¼ì–´ì§„ ëª©ì ì§€ ì ‘ë‘ì‚¬ë¥¼ ê°€ì§„ ë©”ì„¸ì§€ë“¤ì„ ë¸Œë¡œì»¤ê°€ ì²˜ë¦¬í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.
        âˆ´ ì¦‰, í´ë¼ì´ì–¸íŠ¸ê°€ êµ¬ë…í•  ìˆ˜ ìˆëŠ” ë©”ì„¸ì§€ ëª©ì ì§€ì˜ ì ‘ë‘ì‚¬ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
        â–¶ **~/topic**ì„ êµ¬ë…í•˜ê³  ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.
    - `config.setApplicationDestinationPrefixes("/app");`
        : ë©”ì„¸ì§€ ë¼ìš°íŒ… ê²½ë¡œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        ë” ìì„¸íˆ ë§ìí•˜ë©´, í´ë¼ì´ì–¸íŠ¸ê°€ íŠ¹ì • ê²¨ì˜¬ë¡œ ë©”ì„¸ì§€ë¥¼ ë³´ë‚¼ ë•Œ, í•´ë‹¹ ë©”ì„¸ì§€ë¥¼ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì˜ íŠ¹ì • í•¸ë“¤ëŸ¬ ë©”ì„œë“œë¡œ ë¼ìš°íŒ…í•˜ê¸° ìœ„í•œ ì ‘ë‘ì‚¬ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. ì´í›„, controllerì—ì„œ `@MessageMapping` ë©”ì„œë“œì— ë°”ì¸ë”©ë˜ëŠ” ë©”ì„¸ì§€ì˜ ì ‘ë‘ì‚¬ë¥¼ ì§€ì •í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
        â–¶ **~/app**ìœ¼ë¡œ ìˆ˜ì‹ í•œ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- `registerStompEndpoints(StompEndpointRegistry registry)`
    : ì›¹ì†Œì¼“ ì—°ê²°ì— ëŒ€í•œ endpointë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
    - `registry.addEndpoint("/chatting");`
        : í´ë¼ì´ì–¸íŠ¸ê°€ ì›¹ì†Œì¼“ ì—°ê²° ìš”ì²­ì„ ë³´ë‚´ëŠ” endpointë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        â–¶ **~/chatting**ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ì›¹ì†Œì¼“ ì—°ê²° ìš”ì²­ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.


<br/>


## Reqeust DTO ì‘ì„±

í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ì´ë¦„ì„ ì „ë‹¬ë°›ëŠ” Request DTOë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

```java
public class Greeting {

    private String content;

    public Greeting() {}

    public Greeting(String content) {
        this.content = content;
    }

    public String getContent() {
        return content;
    }

}
```
{: file="Greeting.java"}


<br/>


## Response DTO ì‘ì„±

í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬ë°›ì€ ì´ë¦„ì„ ë‹´ê³ ìˆëŠ” Response DTOë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.

```java
public class HelloMessage {

    private String name;

    public HelloMessage() {}

    public HelloMessage(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }

}
```
{: file="HellloMessage.java"}


<br/>


## Contoller êµ¬í˜„

í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬í•˜ê³ , ë‹¤ì‹œ í•´ë‹¹ ì±„íŒ…ì— ì°¸ì—¬í•˜ê³  ìˆëŠ” ëª¨ë“  ì°¸ê°€ìë“¤ì—ê²Œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•˜ëŠ” Controllerë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

```java
import org.springframework.messaging.handler.annotation.MessageMapping;
import org.springframework.messaging.handler.annotation.SendTo;
import org.springframework.stereotype.Controller;
import org.springframework.web.util.HtmlUtils;

@Controller
public class GreetingController {

    @MessageMapping("/hello")
    @SendTo("/topic/greetings")
    public Greeting greeting(HelloMessage message) throws Exception {
        Thread.sleep(1000);
        return new Greeting("Hello " + HtmlUtils.htmlEscape(message.getName()) + " !");
    }

}
```
{: file="GreetingContoller.java"}

- `@MessageMapping("/hello")`: **~/pub/hello**ë¡œ ì „ë‹¬ë°›ì€ í´ë¼ì´ì–¸íŠ¸ì˜ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.
- `@SendTo("/topic/greetings")`: **~/topic/greetings**ë¥¼ êµ¬ë…í•˜ê³  ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.

í´ë¼ì´ì–¸íŠ¸ ì¸¡ì˜ êµ¬í˜„ì€ ìœ„ì— ì²¨ë¶€í•œ Spring Boot ê³µì‹ ë¬¸ì„œì— ìˆëŠ” app.jsì™€ index.html ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. ê³µì‹ë¬¸ì„œì— ì„¤ëª…ë˜ì–´ ìˆëŠ” ê²ƒê³¼ ê°™ì´ ë‘ ê°œì˜ íŒŒì¼ì„ src/main/resources/static ë””ë ‰í„°ë¦¬ ì•ˆì— ë„£ìœ¼ë©´ ë©ë‹ˆë‹¤.



<br/><br/>



---

# ğŸ“¢ ì´ìŠˆ

ì›¹ì†Œì¼“ ë° Stompì— ëŒ€í•´ì„œ ì„¤ì •í•˜ëŠ” WebSocketConfig í´ë˜ìŠ¤ì˜ `registerStompEndpoints(StompEndpointRegistry registry)` ë©”ì„œë“œ ì•ˆì— `registry.addEndpoint("/chatting");` ë’¤ì— SockJSë¥¼ ì‚¬ìš©í•˜ì—¬ WebSocketì„ ì§€ì›í•˜ì§€ ì•ŠëŠ” í™˜ê²½ì—ì„œë„ í´ë°± ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•˜ê¸° ìœ„í•´ì„œ ë¶™ì˜€ë”ë‹ˆ, í´ë¼ì´ì–¸íŠ¸ê°€ ë³´ë‚´ëŠ” ì›¹ì†Œì¼“ ì—°ê²° ìš”ì²­ì„ ë°›ì•„ë“¤ì´ì§€ ëª»í•˜ëŠ” ì´ìŠˆê°€ ë°œìƒí•˜ì—¬ ì¶”ê°€í•˜ì§€ ëª»í•˜ì˜€ìŠµë‹ˆë‹¤... ğŸ˜¥

í•´ë‹¹ ë‚´ìš©ì— ëŒ€í•´ì„œ ì•„ì‹œëŠ” ë¶„ì´ ê³„ì‹œë©´ ëŒ“ê¸€ ë‚¨ê²¨ì£¼ì‹œë©´ ê°ì‚¬í•©ë‹ˆë‹¤. ğŸ¥°



<br/><br/>


---

# ğŸ’¬ ì‹¤í–‰ ê²°ê³¼

ì™¼ìª½ í™”ë©´ì—ì„œ 'ë‘˜ë¦¬'ë¼ëŠ” ì´ë¦„ì„ ì „ì†¡í•˜ë©´, ë‘ í™”ë©´ ëª¨ë‘ì— 'Hello ë‘˜ë¦¬!'ë¼ëŠ” ë©”ì„¸ì§€ê°€ ì¶œë ¥ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

![Desktop View](/assets/img/2024-12-03-tasty-ties-1/ê°„ë‹¨í•œ%20ì±„íŒ…%20ì‹¤í–‰%20í™”ë©´.gif)
_ì‹¤í–‰ ê²°ê³¼_



<br/><br/>



---

ì´ìƒ Spring Bootì™€ WebSocketì„ í™œìš©í•˜ì—¬ ê°„ë‹¨í•œ ì±„íŒ…ì„ êµ¬í˜„í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.
ë‹¤ìŒì— ì´ë¥¼ í™œìš©í•˜ì—¬ ë°©ì„ êµ¬í˜„í•˜ì—¬ ë°©ë§ˆë‹¤ ì±„íŒ…ì„ í•˜ëŠ” ê²ƒì„ êµ¬í˜„í•´ ë³´ê² ìŠµë‹ˆë‹¤.

ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Š

<br/>

> - Spring Boot: 3.3.2

<br/>

[ğŸ³ GitHub - jiwon718/SpringBoot-Chat](https://github.com/jiwon718/SpringBoot_Chat)
